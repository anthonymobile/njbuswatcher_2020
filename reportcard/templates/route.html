{%- extends "base.html" %}


{# Loads some of the macros included with Flask-Bootstrap. We are using the
   utils module here to automatically render Flask's flashed messages in a
   bootstrap friendly manner #}
{% import "bootstrap/utils.html" as utils %}


{# Inside the ``content`` is where you should place most of your own stuff.
   This will keep scripts at the page end and a navbar you add on later
   intact. #}
{% block head %}
<META HTTP-EQUIV="refresh" CONTENT="60">

    <!-- seems to have no effect --> <style> #map { width:100%; } </style>

{{ super() }}
{% endblock %}


{% block breadcrumb %}
<li class="breadcrumb-item"><a href={{ url_for('genRouteReport' ,source='nj',route=routereport.route) }}>{{routereport.route}} {{routereport.prettyname}}</a></li>

{% endblock %}}

{% block scripts %}

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="{{ url_for('static', filename='mdb/css/bootstrap.min.css')}}" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="{{ url_for('static', filename='mdb/css/mdb.min.css')}}" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link href="{{ url_for('static', filename='mdb/css/style.min.css')}}" rel="stylesheet">


    <script type="text/javascript">
        var passed_route = {{ routereport.route }}
        var passed_reportcard_routes = {{ routereport.reportcard_routes|safe }}
    </script>

    </script>
    <script type="text/javascript" src="{{ url_for('static', filename='maps/busmap-route.js')}}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='maps/geojson-extent.js')}}"></script>



{% endblock %}


{% block content_main %}


    <!--Main layout-->
    <main class="mt-2 pt-5">
        <div class="container">


            <!--Section: Menu-->

                <section id="menu" class="text-center">

                <!-- Content -->
                <div class="card-body text-black text-center mt-4 ">

                    <h1 class="mb-4">
                        <strong>Route {{routereport.route}}</strong></h1>
                   <h3 class="mb-4">
                        <strong>
                    {{routereport.prettyname}}</strong>
                    </h3>

                    <p class="mb-4">
                        <strong>{{routereport.description_long}}</strong>
                    </p>
                    <!--<a target="_self" href="#stops" class="btn btn-outline-black btn-lg">Stop Info-->
                        <!--<i class="fas fa-pencil-alt ml-2"></i>-->
                    <!--</a>-->
                    <a target="_self" href="#route_performance" class="btn btn-outline-black btn-lg">Current Stats (Last 2 Hours)
                        <i class="fas fa-map ml-2"></i>
                    </a>

                    <a target="_self" href="#map_line" class="btn btn-outline-black btn-lg">Live Map
                        <i class="fas fa-graduation-cap ml-2"></i>
                    </a>

                    <a target="_self" href="#current_service" class="btn btn-outline-black btn-lg">On the Road (Trip Tracker)
                        <i class="fas fa-graduation-cap ml-2"></i>
                    </a>


                </div>
                <!-- Content -->
            </section>
            <!--Section: Menu-->


            <hr id="route_performance" class="my-5">


            <!--Section: Route Performance-->
            <section  class="text-left">
                     <h1 class="mb-4">
                        <strong>Route Performance</strong>
                    </h1>


                <!--Grid row-->
                <div class="row mb-4 wow fadeIn">

                    <!--Grid column-->
                    <div class="col-lg-4 col-md-12 mb-4">

                        <!--Card-->
                        <div class="card">

                            <!--Card image-->
                            <!--
                            <div class="view overlay">
                                <div class="embed-responsive embed-responsive-16by9 rounded-top">
                                    <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/cXTThxoywNQ" allowfullscreen></iframe>
                                </div>
                            </div>
                            -->

                            <!--Grade Card-->


                            {% if (routereport.grade=='A' or routereport.grade=='B') %}
                                <div class="card-body table-success">
                            {% elif routereport.grade=='C' %}
                                <div class="card-body table-warning">
                            {% elif (routereport.grade=='D' or routereport.grade=='F') %}
                                <div class="card-body table-danger">
                            {% elif (routereport.grade=='N/A') %}
                                <div class="card-body table-secondary">
                            {% endif %}

                                <div class="row mb-4 wow fadeIn">
                                <div class="col-lg-4 col-md-12 mb-4 text-center">
                                <!--Title-->
                                <h4 class="card-title ">{{routereport.period_label}} Grade</h4>
                                <h1 class="card-title ">{{routereport.grade}}</h1>

                                </div>
                                <div class="col-lg-8 col-md-12 mb-4">
                                {{routereport.grade_description}}

                                </div>


                            </div>
                            </div>

                        </div>
                        <!--/.Card-->


                    </div>
                    <!--Grid column-->



                    <!--Grid column-->
                    <div class="col-lg-4 col-md-12 mb-4">

                        <!--Card-->
                        <div class="card">

                            <!--Card image-->
                            <!--
                            <div class="view overlay">
                                <div class="embed-responsive embed-responsive-16by9 rounded-top">
                                    <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/cXTThxoywNQ" allowfullscreen></iframe>
                                </div>
                            </div>
                            -->

                            <!--Card content-->
                            <div class="card-body">
                                <!--Title-->
                                <h4 class="card-title">Buses are running every {{routereport.avg_headway['time']}} minutes.</h4>
                                That's {{routereport.avg_headway['description']}}.

                            </div>

                        </div>
                        <!--/.Card-->

                        <!--Card-->
                        <div class="card mt-4">

                        {% if routereport.traveltime['label'] != 'below' %}
                        <div class="card-body table-danger">
                        {% else %}
                        <div class="card-body table-success">
                        {% endif %}

                            <!--Card image-->
                            <!--
                            <div class="view overlay">
                                <div class="embed-responsive embed-responsive-16by9 rounded-top">
                                    <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/cXTThxoywNQ" allowfullscreen></iframe>
                                </div>
                            </div>
                            -->

                            <!--Card content-->

                                <!--Title-->
                                <h4 class="card-title">Travel times are good.</h4>

                                Average end-to-end travel time today for Route {{routereport.route}} is {{routereport.traveltime['time']}} minutes. Thats {{routereport.traveltime['percent']}} percent {{routereport.traveltime['label']}} normal.


                                <div id="buses" class="row mt-2">


                                </div>




                            </div>

                        </div>
                        <!--/.Card-->
                        </div>



                    <!--Grid column-->

                    <!--Grid column-->
                    <div class="col-lg-4 col-md-12 mb-4">

                        <!--Card-->
                        <div class="card">

                            <!--Card image-->
                            <!--
                            <div class="view overlay">
                                <div class="embed-responsive embed-responsive-16by9 rounded-top">
                                    <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/cXTThxoywNQ" allowfullscreen></iframe>
                                </div>
                            </div>
                            -->

                            <!--Card content-->
                            {% if routereport.dependability['status'] != 'reliable' %}
                            <div class="card-body table-danger">
                            {% else %}
                            <div class="card-body table-success">
                            {% endif %}
                                <!--Title-->
                                <h4 class="card-title">There's a lot of bunching.</h4>

                                {% if routereport.dependability['status'] != 'reliable' %}

                                Service is {{routereport.dependability['status']}}. You should expect {{routereport.dependability['message']}} of {{routereport.dependability['lower']}} to {{routereport.dependability['upper']}} minutes.

                                {% else %}

                                Service is operating normally. No expected delays.

                                {% endif %}

                                <div id="buses" class="row mt-2">


                                </div>




                            </div>

                        </div>
                        <!--/.Card-->




                    </div>
                    <!--Grid column-->



                </div>
                <!--Grid row-->


            </section>
            <!--Section: Route Performance-->


            <hr id="map_line" class="my-5">


            <!--Section: Map-->
            <section id="map_box">

             <h1 class="mb-4 mt-4">
                        <strong>Live Map</strong>
                    </h1>
                <!--Grid row-->
                <div class="row mb-4 wow fadeIn">


                     <!--Map column-->
                     <div  class="col-lg-12 col-md-12">

                        <div id="map" class="container">
                        </div>

                     </div>
                </div>
            </section>


            <hr id="current_service" class="my-5">

            <!--Section: On the Road Now-->
            <section>
                     <h1 class="mb-4 mt-4">
                        <strong>Buses On the Road Now</strong>
                    </h1>

                <!--Grid row-->
                <div class="row mb-4 wow fadeIn">

                    {% for trip_id,trip_dict in routereport.tripdash.items() %}

                    <!--Grid column-->
                    <div class="col-lg-4 col-md-12 mb-4">


                        <!--Card-->
                        <div class="card">

                            <!--Card content-->
                            <div class="card-body">
                                <!--Title-->
                                <p class="card-title">To {{ trip_dict['pd'] }} (#{{ trip_id | split_(0) }})</p>
                                <div class="row mt-2">

                                    <table class="table table-sm table-hover">


                                                <tbody>
                                                {% for stop in trip_dict['stoplist'] %}
                                                 <tr class='table text-left'>

                                                 {% if stop.arrival_timestamp is not none %}
                                                     <td class="table-primary"><span class="small">{{stop.arrival_timestamp|strftime_today}}</span></td>
                                                     <td class="table-secondary">
                                                         <a href = {{url_for('genStopReport',source=routereport.source,route=routereport.route,stop=stop.stop_id,period='daily') }} id="{{stop.st}}">
                                                         <span class="small">{{stop.stop_name|title}}
                                                     </span>
                                                     </a></td>





                                                 {% else %}
                                                     <td><small>--</small></td>
                                                     <td><small>{{stop.stop_name|title}}</small></td>
                                                 {% endif %}

                                                </tr>


                                                {% endfor %}

                                                </tbody>
                                    </table>

                                </div>

                            </div>
                            <!--/.Card-->


                        </div>
                        <!--Grid column-->

                    </div>
                    <!--Grid row-->
                    {% endfor %}
                </div>

             </section>
            <!--Section: On the Road Now-->



            <!--&lt;!&ndash;Section: Stops&ndash;&gt;-->
            <!--<hr id="stops" class="my-5">-->

            <!--<section class="text-left">-->
                     <!--<h1 class="mb-4">-->
                        <!--<strong>Stops</strong>-->
                    <!--</h1>-->
                    <!--<p class="mb-4">-->
                        <!--<strong>The following is complete list of stops on the {{routereport.route}}, grouped by direction and service. Click on a stop for a detailed report of current and past service at that location.</strong>-->
                    <!--</p>-->

                <!--&lt;!&ndash;Grid row&ndash;&gt;-->
                <!--<div class="row mb-4 wow fadeIn">-->


                    <!--{% for path in routereport.route_stop_list %}-->
                    <!--&lt;!&ndash;Grid column&ndash;&gt;-->
                    <!--<div class="col-lg-4 col-md-12 mb-4">-->

                        <!--&lt;!&ndash;Card&ndash;&gt;-->
                        <!--<div class="card">-->

                            <!--&lt;!&ndash;Card image&ndash;&gt;-->
                            <!--&lt;!&ndash;-->
                            <!--<div class="view overlay">-->
                                <!--<div class="embed-responsive embed-responsive-16by9 rounded-top">-->
                                    <!--<iframe class="embed-responsive-item" src="https://www.youtube.com/embed/cXTThxoywNQ" allowfullscreen></iframe>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--&ndash;&gt;-->

                            <!--&lt;!&ndash;Card content&ndash;&gt;-->
                            <!--<div class="card-body">-->
                                <!--&lt;!&ndash;Title&ndash;&gt;-->
                                <!--<h4 class="card-title">To {{path.dd}}</h4>-->

                                <!--<div id="buses" class="row mt-2">-->

                                    <!--{% for stop in path.stops %}-->
                                    <!--<a href = {{url_for('genStopReport',source=routereport.source,route=routereport.route,stop=stop.identity,period='daily') }} id="{{stop.st}}"><span class="label">{{stop.st|title}}-</span>-->
                                    <!--</a>-->
                                    <!--{% endfor %}-->

                                <!--</div>-->


                            <!--</div>-->

                        <!--</div>-->
                        <!--&lt;!&ndash;/.Card&ndash;&gt;-->


                    <!--</div>-->
                    <!--&lt;!&ndash;Grid column&ndash;&gt;-->
                    <!--{% endfor %}-->


                <!--</div>-->
                <!--&lt;!&ndash;Grid row&ndash;&gt;-->


            <!--</section>-->
            <!--&lt;!&ndash;Section: Stops&ndash;&gt;-->





            <!--&lt;!&ndash;Section: Current Service&ndash;&gt;-->
            <!--<section id="current_service">-->
                     <!--<h1 class="mb-4 mt-4">-->
                        <!--<strong>On the Road Now</strong>-->
                    <!--</h1>-->



                <!--&lt;!&ndash;Grid row&ndash;&gt;-->
                <!--<div class="row mb-4 wow fadeIn">-->


                    <!--{% for trip in routereport.active_trips %}-->

                    <!--&lt;!&ndash;Grid column&ndash;&gt;-->
                    <!--<div class="col-lg-4 col-md-12 mb-4">-->

                        <!--&lt;!&ndash;Card&ndash;&gt;-->
                        <!--<div class="card">-->

                            <!--&lt;!&ndash;Card content&ndash;&gt;-->
                            <!--<div class="card-body">-->
                                <!--&lt;!&ndash;Title&ndash;&gt;-->
                                <!--<h4 class="card-title">Bus {{ trip.trip_id | split_(0) }}</h4>-->
                                <!--&lt;!&ndash;-->
                                <!--<h4 class="card-title">{{trip.trip_id}}</h4>-->
                                <!--&ndash;&gt;-->
                                <!--&lt;!&ndash;Text&ndash;&gt;-->
                                <!--<div id="buses" class="row mt-2">-->


                                    <!--<table class="table table-sm table-hover">-->
                                                <!--<thead class="thread-dark">-->
                                                <!--<tr>-->
                                                    <!--<th>Arrival</th>-->
                                                    <!--<th>Stop</th>-->
                                                <!--</tr>-->
                                                <!--</thead>-->

                                                <!--<tbody>-->
                                                <!--{% for stop in trip.trip_card %}-->
                                                <!--{%if stop.arrival_timestamp != none %}-->


                                                    <!--<tr class='table-success'>-->

                                                <!--<tr class='table text-left'>-->

                                                    <!--<td>{{stop.arrival_timestamp|strftime_today}}</td>-->
                                                    <!--<td>{{stop.stop_name|title}}</td>-->
                                                <!--</tr>-->
                                                <!--{% endif %}-->

                                                <!--{% endfor %}-->

                                                <!--</tbody>-->
                                    <!--</table>-->

                                <!--</div>-->




                            <!--</div>-->

                        <!--</div>-->
                        <!--&lt;!&ndash;/.Card&ndash;&gt;-->


                    <!--</div>-->
                    <!--&lt;!&ndash;Grid column&ndash;&gt;-->


                    <!--{% endfor %}-->



                <!--</div>-->
                <!--&lt;!&ndash;Grid row&ndash;&gt;-->


            <!--</section>-->
            <!--&lt;!&ndash;Section: Current Service&ndash;&gt;-->




        </div>


    </main>
    <!--Main layout-->


{% endblock %}
